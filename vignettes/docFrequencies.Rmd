---
title: "The docFrequencies Object"
author: "Travis Mullen"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
<style>
table th, table td {
  border-left-style: solid;
  border-right-style: solid;
  border-bottom: solid;
  border-width: thin;
  border-top-style: solid;
  border-color: #A09F9F;
}
</style>
# Introduction
***
The `docFrequencies` object is an essential part of the `tei2r` package and a very useful tool in analyzing your corpus. The `docFrequencies` (`df`) object holds frequency data for terms in your corpus within each document and (optionally) the corpus as a whole.  `df` has several slots in which information is stored:^[Items marked with an <span style="color: red">*</span> are optional parts of these objects.]

  - `directory` a string that gives the full path to the main directory (folder) that houses your corpus of texts.
  - `indexFile` a string that gives the full path to the file that contains your index file (the meta-data for your corpus).
  - `raw` a list of the raw frequencies of each term in each document in your corpus.
  - `proportional` a list of the proportional frequency of each word in each document.  That is, the calculation of the frequency of `x` term's appearance in each document divided by the total number of words in the document. (`f(x)/total(document)`)
  - `vocabulary`<span style="color: red">*</span> a list of the raw frequencies of each term in the whole corpus.
  - `proportionalVocab`<span style="color: red">*</span> a list of the proportional frequencies of each term across the whole corpus.  That is, the calculation of the frequency of `x` term's appearance in the whole corpus divided by the total number of words in the document. (`f(x)/total(corpus)`)^[This calculation can take a very long time depending on the size of your corpus.]

***
# `docFrequency`'s Slots

The first two slots in the docFrequencies object are used to help identify which corpus the object is connected with by providing the directory for both the text and index file.

## `df@raw`
`df@raw` holds a list of word frequencies seperated by document.  The indices in this slot are named with the `id` that is derived from your `index`.  For example, `df@raw[1]`^[The table below is based on a sample data set. The frequencies are derived from Wollstonecraft's _A Serious Proposal to the Ladies_] would look like:  
  
  |  x    | A26092 |
  |------:|-------:|
  | world |   69   |
  | good  |   69   |


to access a single element of `df@raw[1]` you'll need to get into the internal element of the list: `df@raw[[1]][1]`.  Here, the double brackets (`[[]]`) indicate that you want to get at the _value_ of `df@raw[1]`'s elements and the second set of brackets is the index (or location) within that list of the value that you are looking for.  `df@raw[[1]][1]`'s value would be `69`.  That element's label (or `name`) is the term that corresponds with the value.  So `names(df@raw[[1]][1])` would return `world`.  When you type `df@raw[[1]][1]` you'll see:

```
            world  
               69
```

so you'll know which term you're looking at when accessing a term in `df@raw` in this way.

To find a specific term within a specifica document, you can use the following code:

```r
  df@raw[['id']]['term']
```

For example, `df@raw[['A26092']]['grave']` returns:

```
            grave
                2
```

## `df@proportional`
`df@proporional` holds a list of proportional word frequencies seperated by document.  This means that the frequencies found for each word are proportional to the number of words in the whole document `(f(x)/(total # words))`.  The indices in this slot are named with the `id` that is derived from your `index`.

What good is proportional frequency?  It helps you gain an understanding of the importance of the magnitude of the word's overall frequency.  If, for example, `well` occurs 41 times in Wollstonecraft's _A Serious Proposal to the Ladies_, but there are 8165 words in the text, its importance is diminished.  While `well` is the 8th most frequently occurring term in this text, its proportional frequency is `0.005021433`.  To access a particular element, the command is very similar to that of `df@raw`.  To access the first word in the first document, for example, the command would be: `df@proportional[[1]][1]` which would return:

```
            world
      0.008450704
```

The command for finding a specific term in a specific document is also the same:

```r
  df@proportional[['id']]['term']
```

For example, `df@proportional[['A26092']]['just']` returns:

```
            just
    0.0002449479
```

## `df@vocabulary`
`df@vocabulary` holds a list of the frequency of each word in the whole corpus.  The words are no longer separated by document, but are counted as they occur across the entire collection of documents.  Comparing a term's overall frequency to the frequency or position in the ranking of frequent words in a document can be very helpful.  For example, in Wollstonecraft's text, `world` is the most common term in the whole document (along with 'great'), appearing 69 times.  In the overall corpus, `world` appears `3020` times.  It would be interesting to find where `world` fits in among the ranking of terms in the whole corpus. To do that, we run:

```r
which(names(df@vocabulary) == 'world')
```

This command will give us the index, or location, at which `world` appears within the whole vocabulary of the corpus (which is also ranked from greatest to least).  How does this command work?  The `which()` command will tell us exactly that: which index in a list matches the criteria inside the parenthesis.  We have to check the `names()` of `df@vocabulary` because the list is a set of named frequencies.  If we looked for `which(df@vocabulary == 'world')` we wouldn't get anything back because `R` would be looking for the character string `world` and only finding numbers (we'd end up with `named integer(0)`, so if you see this print in your console, you may want to use `names()`). The `==` checks for equivalency, whereas `=` assigns a value.  

Our command lets us know that `world` is the `55`th term in our `df@vocabulary` list, which is fairly high in the total number of words(`length(df@vocabulary)`).  Perhaps our corpus has a preoccupation with `world`?  It would be interesting to investigate the way in which the term is being used across the corpus (We should run a [Concordance]('docConcordance.html') for `world`).  

To access a single element of `df@vocabulary`, you can run `df@vocabulary[i]` where `i` is the index of the term.  You can also use `df@vocabulary['term']`.

## `df@proportionalVocab`
`df@proportionalVocab` holds a list of the proportional frequency of each term across the corpus.  That is, the frequency of the terms in proportion to the overall number of terms in the whole collection of documents (`f(x)/(total # words in corpus)`).  To access a particular value in the `df@proportionalVocab`, you'll follow the same formula as above: `df@proportionalVocab[i]` and `df@proportionalVocab['term']`.  Additionally, with `df@proportionalVocab` you have the option of accessing elements in a new way: `df@proportionalVocab$term`.  For example: `df@proportionalVocab$world` yields the proportional frequency of `world` across the whole corpus: `0.001554455`.


## Diagram

![docFrequencies structure](./img/df_diagram.png)  
The object structure of the `docFrequencies` object and how to access its elements.

## Examples

```r
  > library(tools)
  > library(XML)
  
  > dl = buildDocList(directory = "./data/sampleSetOne/", 
                  indexFile="./data/sampleSetOne/index.csv", 
                  stopwordsFile = "./data/stopword_list.txt")
  > dt = getTexts(dl)
  > df = getFrequencies(dt)
  > df@raw[[1]]['world']
  world
     69
```
***
# Extending `docFrequencies` with Analysis
Below you can find helpful examples and functions for performing analysis with the `docFrequencies` object.

  1. `tfidf` - Term Frequency Inverse Document Frequency is both a function in the `tei2r` package and an important method for analyzing your frequency data.  To learn more about it, please read the [tfidf vignette]('tfidf.html'). To use `tfidf`, you'll run the command:
  
```r
  tf = tfidf(df, 'term') # or,  
  tf = tfidf(df, c('term1', 'term2', 'term3')) # or,  
  tf = tfidf(df, all=T) # or  
  tf = tfidf(df, all=T, limit=1000)  
```
  
  2. Graphing
