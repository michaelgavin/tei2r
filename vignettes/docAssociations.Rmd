---
title: "The docAssociations Object"
author: "Travis Mullen"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{"The docAssociations Object"}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
# Introduction
The `docAssociations` object is designed to help solve a number of problems.  It can provide a good overview of a term's use in a document by showing you the words that occur alongisde the term and the number of times that they occur with the term.  Analyzing this information can help you develop an understanding of the way that term functions in a given document and a given corpus.

Say you wanted to find the words that occur most often alongside 'rights' in the Natural Law sample corpus.  Looking at the `docAssociations` object would be the best place to start exploring that problem.  To use the `docAssociations` object, you will need to have a `docConcordance` and a `docFrequencies` object.  Finding the associations for your corpus and term are simple; you just have to run `da = associations(dc, df)`.  To access the associations for your key term in a given document, you can run `da@associations$ID` where `ID` is the ID number of the document from your `index`.

A more technical description can be found below in the 'What it is' section.

## What it is:
The `docAssociations` object holds the frequency of all words associated with a given `term` across all documents in your corpus.  It relies on the `docConcordance` and `docFrequencies` objects for its data.  The `docAssociations` object is especially helpful for helping to establish a definition of a term in your particular corpus or accross time.^[It's even better when combined with [Term Frequency Inverse Document Frequency]('tfidf.html').]  The object maintains the metadata with which the concordance was originally calculated like the `term` and `context`.  The `docAssociations` object takes each set of concordances for each document, combines them, and then calculates the frequency with which all the terms occur in the concordance.  It also holds a list of the proportional frequency of the associations.  That is, the frequency that the term occurs within the concordance for each document divided by the frequency with which the term occurs in the whole document (`f(xC)/f(xD)`).

The `docAssociations` object has several slots that store information:

  - `directory` a string that gives the full path to the main directory (folder) that houses your corpus of texts.
  - `indexFile` a string that gives the full path to the file that contains your index file (the meta-data for your corpus).
  - `term` a string that holds the term that is used to generate the concordance.  This is helpful for keeping track of your `docConcordance` objects if you have more than one.  For example, if I have two `docConcordance` objects, one that is the concordance of the term "just" in a corpus of Locke and his contemporaries and one that is the concordance of the term "right" in the same corpus, I can figure out which object is which by saying `dc1@term` or `dc2@term` (where `dc1` and `dc2` are the names of the different objects).
  - `context` the context used to generate the concordance in each document.  The context is the number of words on each side of the search term to include in the concordance.  Take, for example, the sentence: "Jack runs faster than Jane does sometimes." If we had `context=2` and `term = "than"`, the return would be `["runs", "faster", "than", "Jane", "does"]` (`[-2]than[+2]`).
  - `associations` a list that contains a list of the frequencies of the words that are associated (co-occur) with `term` for each document.  The number of elements in this list will be equivalent to the number of documents in your corpus.
  - `proportions` A list that contains a list of the proportional frequency of the words associated with `term`.  This is derived by determining the ratio of the word's frequency appearance with `term` to its proportional frequency across the whole document.
  
Accessing the values of the `docAssociations` object works in much the same way as the other objects in the `tei2r` package.  To access the frequency values for the words that co-occur with `term` in a given document, you would run `da@associations[i]` where `i` is the index of the document.  Alternatively, you can use the `$` notation: `da@associations$A26092`.  Either of these will return something like:
```
        just         sway sufficiently   remissness         real    prejudice   perfection     occasion        nsorm          now    mentioned 
           2            1            1            1            1            1            1            1            1            1            1 
        know     interest   indiscreet    excellent       course       charge    authority       author       assert    arbitrary 
           1            1            1            1            1            1            1            1            1            1 
```

The best way to find the frequency of a given term within this set is `da@associations$A26092['term']` where `A26092` is the `id` of the document and `term` is the desired word. Accessing the proportional frequency of these terms works in the same way: `da@proportions[1]` or `da@proportions$A26092`.

***

# `docAssociations`' Slots

The First four slots of the `docAssociations` object are designed to help keep track of its origin and the corpus to which it is associated.  These slots (`directory`, `indexFile`, `term`, and `context`) store the meta-data for the associations that are contained in the object.  They let you know which set of files were used to create the object and the `term` and `context` that were used to create the concordance from which the data in the `docAssociations` object is derived.

## `da@associations`
The `associations` slot holds a list of words that are associated, or co-occur, with `term` and the frequency with which the words co-occur with `term`.  The length of this list will be equal to the number of documents in your corpus.  The length of the individual lists will vary depending upon the number of words that co-occur with your given `term`.  There are several ways by which you can access the values for a given document:

  - `da@associations[i]` [where `i` is the index of the document in the list] will return all of the words that are associated with `term` in `i` document and the frequency with which they co-occur.
  - `da@associaitons$id` [where `id` is the identifier of the document in the list] will return all of the words that are associated with `term` in `id` document and the frequency with which they co-occur.
  - `da@associations$id[n]` [where `id` is the identifier of the document and `n` is the index of the word in the list] will return the frequency with which `n` word in `id` document co-occurs with `term`.
  - `da@associations$id['word']` [where `id` is the identifier of the document and `word` is the desired word in the list] will return the frequency with which `word` in `id` document co-occurs with `term`.^[This will only work if `word` is actually in the list]
  
## `da@proportions`
The `proportions` slot holds a list of the proportional frequency of the words associated with `term`.  This is derived by determining the ratio of the word's frequency of apperance with `term` to its proportional frequency in the whole corpus.  This enables the examination of the importance of the word's co-occurrance with `term`.  Exceedingly high values, for example, likely indicate that the word only occurs with `term` in the document.  The number of items in this list will be equivalent to the number of documents in your corpus.  The number of items within each document's list will vary depending on the number of words that occur with `term` in the document.  It should, however, be equivalent to the number of items in the document's `associations` list.  You can access `proportions` in the same way that you access `associations`:

  - `da@proportions[i]` [where `i` is the index of the document in the list] will return all of the words that are associated with `term` in `i` document and the proportional frequency with which they co-occur.
  - `da@proportions$id` [where `id` is the identifier of the document in the list] will return all of the words that are associated with `term` in `id` document and the proportional frequency with which they co-occur.
  - `da@proportions$id[n]` [where `id` is the identifier of the document and `n` is the index of the word in the list] will return the proportional frequency with which `n` word in `id` document co-occurs with `term`.
  - `da@proportions$id['word']` [where `id` is the identifier of the document and `word` is the desired word in the list] will return the proportional frequency with which `word` in `id` document co-occurs with `term`.^[This will only work if `word` is actually in the list]

## Diagram

![docAssociations structure](./img/da_diagram.png)  

## Examples

```r
  > library(tools)
  > library(XML)
  
  > dl = buildDocList(directory = "./data/sampleSetOne/", 
                  indexFile="./data/sampleSetOne/index.csv", 
                  stopwordsFile = "./data/stopword_list.txt")
  > dt = getTexts(dl)
  > dc = getConcordance(dt = dt, term = 'just', context = 5)
  > df = getFrequencies(dt)
  > da = getAssociations(df = df, dc = dc)
  > da@associations$A26092
        just         sway sufficiently   remissness         real    prejudice   perfection     occasion        nsorm          now    mentioned 
           2            1            1            1            1            1            1            1            1            1            1 
        know     interest   indiscreet    excellent       course       charge    authority       author       assert    arbitrary 
           1            1            1            1            1            1            1            1            1            1 
  > da@proportions$A26092
        just         sway sufficiently   remissness         real    prejudice   perfection     occasion        nsorm          now    mentioned 
   2200.2299   20668.1170    6090.2915  194280.3000   17192.9469    7142.6581    7331.3321    1341.7148   21117.4239     470.6403    3794.5371 
        know     interest   indiscreet    excellent       course       charge    authority       author       assert    arbitrary 
    969.4626    1753.4323  129520.2000    4346.3154    3624.6325    2899.7060     568.7362    2519.8482   27363.4225    7929.8082 
```

***
# Extending `docAssociations` with Analysis
The `docAssociations` object can be very helpful in analyzing the way a particular `term` is used in your corpus.  Especially when combined with term frequency inverse document frequency [tfidf]('tfidf.html').
